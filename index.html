<script>
    let records = [];
    let editingIndex = -1;

    const STORAGE_KEY = "fun_run_records";

    function saveToLocalStorage() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
    }

    function loadFromLocalStorage() {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (stored) {
            records = JSON.parse(stored);
            updateTable();
            updateStats();
        }
    }

    function addRecord() {
        const date = document.getElementById('date').value;
        const weekday = document.getElementById('weekday').value;
        const location = document.getElementById('location').value;
        const time = document.getElementById('time').value;
        const activityType = document.getElementById('activityType').value;
        const distance = parseFloat(document.getElementById('distance').value);
        const weather = document.getElementById('weather').value;
        const participantsList = document.getElementById('participants').value;
        const notes = document.getElementById('notes').value;

        if (!date || !weekday || !location || !time || !activityType || !distance || !weather || !participantsList.trim()) {
            alert('請填寫所有必填欄位！');
            return;
        }

        const participantCount = participantsList.split(/[,，、\n]/).filter(nam
